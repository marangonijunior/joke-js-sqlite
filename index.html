<!DOCTYPE html>
<html>
    <script src='sql-wasm.js'></script>
<body>

<h2>Joke - SQLite</h2>

<button type="button" onclick="loadJoke()">Random Joke</button>

<h3>Random Joke</h3>
<p id="joke"></p>
<script>

function loadJoke() {
    
    var initSqlJs = window.initSqlJs;

  

    config = {
      locateFile: filename => `joke.db`
    }

    initSqlJs(config).then(function(SQL){
      //Create the database
      var db = new SQL.Database();
      // Run a query without reading the results
      var contents = db.exec("SELECT * FROM my_table");
      console.log(contents)
    });

    // var db = null
    // initSqlJs({ locateFile: filename => `file:///Users/marangonijunior/Documents/GitHub/marangonijunior/joke-js-sqlite/joke.db` }).then(function(SQL){
    //    db = new SQL.Database();
    // });

    // var xhr = new XMLHttpRequest();
    //     xhr.open('GET', 'joke.db', true);
    //     xhr.responseType = 'arraybuffer';

    //     xhr.onload = function(e) {
    //         var uInt8Array = new Uint8Array(this.response);
    //         var db = new SQL.Database(uInt8Array);
    //         var contents = db.exec("SELECT * FROM jokes");
    //         console.log('Here is a contents: ' + JSON.stringify(contents));
    //     };
    //     xhr.send();

        // var xhr = new XMLHttpRequest();
        // xhr.open('GET', 'joke.db', true);
        // xhr.responseType = 'arraybuffer';

        // xhr.onload = function(e) {
        //     console.log(e)
        // //   var uInt8Array = new Uint8Array(this.response);
        // //   var db = new SQL.Database(uInt8Array);
        // //   var contents = db.exec("SELECT * FROM my_table");
        // // contents is now [{columns:['col1','col2',...], values:[[first row], [second row], ...]}]
        // };
        // xhr.send();   


    // Prepare a statement
    // var stmt = db.exec("SELECT * FROM jokes");
    // stmt.getAsObject({$start:1, $end:1}); // {col1:1, col2:111}

    // // Bind new values
    // stmt.bind({$start:1, $end:2});
    // while(stmt.step()) { //
    //     var row = stmt.getAsObject();
    //     console.log('Here is a row: ' + JSON.stringify(row));
    // }

    // var myHeaders = new Headers();
    // myHeaders.append("Content-Type", "arraybuffer");

    // var raw = JSON.stringify({"query":{"bool":{"must":[{"term":{"contenttype":"I18nonlinebankTest"}}]}},"size":100});

    // var requestOptions = {
    //     method: 'POST',
    //     headers: myHeaders,
    //     body: raw
    // };

    // fetch("https://dev.coop.dotcmscloud.com/api/es/search", requestOptions)
    // .then(response => response.json())
    // .then(result => {
    //     var i18n = result.contentlets[0].contentCoop;
    //     var resultI18N = JSON.parse(i18n.trim().toString());
    //     document.getElementById("nameI18n").innerHTML = result.contentlets[0].nameI18n;
    //     document.getElementById("contentCoopTitle").innerHTML = resultI18N.title;
    //     document.getElementById("contentCoop").innerHTML = JSON.stringify(resultI18N);

    // })
    // .catch(error => console.log('error', error));
}
</script>

</body>
</html>